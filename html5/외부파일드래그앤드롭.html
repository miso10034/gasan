<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>외부파일 드래그 앤 드롭</title>
    <style>
        #droparea{
            width : 450px;
            height : 400px;
            border : 5px dashed slateblue;
            margin-top : 30px; 
            align-items: center;
            justify-content: center;
        }
        img{
            max-width: 100%;
            max-height: 100% ;
        }
    </style>
</head>
<body>
    <h2>이미지 요소 드래그 앤 드롭</h2>

    <div id="droparea" ondragenter="dragenter(event)" ondrop="drop(event)"
        ondragover="dragover(event)"></div><p></p>
    <script>
        var droparea = document.getElementById("droparea");
        var dropImage = document.createElement("img");

        function dragenter(e){
            e.preventDefault();
        }
        function dragover(e){
            e.preventDefault();
        }
        function drop(e){
            // 드랍했을때 외부이미지 할당
            var file = e.dataTransfer.files[0];
            var reader = new FileReader();

            // onload => 파일을 읽어서 로드가 끝났을 때를 가리킴
            // reader.onload =  (function(theFile){
            //     return  function(e){
            //         alert("ondrop");
            //         dropImage.src = e.target.result;
            //         droparea.appendChild(dropImage);
            //     };
            // })(file);

            //리팩토링
            reader.onload =  function(e){
                alert("ondrop");
                dropImage.src = e.target.result;
                droparea.appendChild(dropImage);
                };
                reader.readAsDataURL(file);
                e.preventDefault();
            }
            
        

        
    </script>
</body>
</html>